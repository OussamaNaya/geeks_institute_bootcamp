<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Currency Converter</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root {
    --gold: #c9a84c; --gold-light: #e8c96d;
    --dark: #0d0d0d; --panel: #141414;
    --border: rgba(201,168,76,0.25); --text: #f0ead8;
    --muted: rgba(240,234,216,0.45);
  }
  body {
    min-height: 100vh; background: var(--dark);
    display: flex; align-items: center; justify-content: center;
    font-family: 'DM Mono', monospace;
  }
  body::before {
    content: ''; position: fixed; inset: -50%;
    background: radial-gradient(ellipse 60% 40% at 20% 30%, rgba(201,168,76,0.08) 0%, transparent 60%),
                radial-gradient(ellipse 50% 50% at 80% 70%, rgba(201,168,76,0.05) 0%, transparent 60%);
    animation: breathe 8s ease-in-out infinite alternate;
  }
  @keyframes breathe { from{transform:scale(1)} to{transform:scale(1.1)} }

  .card {
    position: relative; width: 440px;
    background: var(--panel); border: 1px solid var(--border);
    padding: 48px 40px;
    box-shadow: 0 0 80px rgba(201,168,76,0.07), 0 40px 80px rgba(0,0,0,0.6);
    animation: fadeUp 0.8s cubic-bezier(0.16,1,0.3,1) both;
  }
  @keyframes fadeUp { from{opacity:0;transform:translateY(30px)} to{opacity:1;transform:translateY(0)} }
  .card::before, .card::after {
    content:''; position:absolute; width:20px; height:20px;
    border-color:var(--gold); border-style:solid;
  }
  .card::before { top:-1px; left:-1px; border-width:2px 0 0 2px; }
  .card::after { bottom:-1px; right:-1px; border-width:0 2px 2px 0; }

  h1 {
    font-family:'Playfair Display',serif; font-size:2rem; font-weight:700;
    color:var(--text); text-align:center; letter-spacing:0.02em; margin-bottom:6px;
  }
  .subtitle {
    text-align:center; font-size:0.6rem; letter-spacing:0.2em;
    text-transform:uppercase; color:var(--gold); margin-bottom:36px;
  }
  .field { margin-bottom:18px; }
  label {
    display:block; font-size:0.58rem; letter-spacing:0.2em;
    text-transform:uppercase; color:var(--gold); margin-bottom:8px;
  }
  select, input[type="number"], input[type="text"] {
    width:100%; background:rgba(255,255,255,0.03); border:1px solid var(--border);
    color:var(--text); font-family:'DM Mono',monospace; font-size:0.83rem;
    padding:13px 16px; outline:none;
    transition:border-color 0.2s, background 0.2s;
  }
  select {
    appearance:none; -webkit-appearance:none; cursor:pointer;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%23c9a84c' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
    background-repeat:no-repeat; background-position:right 14px center; padding-right:38px;
  }
  select option { background:#1a1a1a; }
  select:focus, input:focus { border-color:var(--gold); background:rgba(201,168,76,0.05); }

  .pair-row { display:flex; gap:10px; align-items:flex-end; margin-bottom:18px; }
  .pair-row .field { flex:1; margin-bottom:0; }
  .switch-btn {
    flex-shrink:0; width:42px; height:42px; background:transparent;
    border:1px solid var(--border); color:var(--gold); cursor:pointer;
    display:flex; align-items:center; justify-content:center;
    transition:all 0.2s; margin-bottom:1px;
  }
  .switch-btn:hover { background:rgba(201,168,76,0.1); border-color:var(--gold); }
  .switch-btn svg { transition:transform 0.4s cubic-bezier(0.34,1.56,0.64,1); }
  .switch-btn.spinning svg { transform:rotate(180deg); }

  .amount-row { display:flex; gap:10px; align-items:flex-end; margin-bottom:24px; }
  .amount-row .field { flex:1; margin-bottom:0; }
  .convert-btn {
    flex-shrink:0; background:var(--gold); border:none; color:var(--dark);
    font-family:'DM Mono',monospace; font-size:0.68rem; font-weight:500;
    letter-spacing:0.15em; text-transform:uppercase; padding:0 20px; height:42px;
    cursor:pointer; transition:all 0.2s; white-space:nowrap;
  }
  .convert-btn:hover { background:var(--gold-light); }
  .convert-btn:active { transform:scale(0.97); }

  .result-box {
    background:rgba(201,168,76,0.05); border:1px solid var(--border);
    padding:20px; text-align:center; min-height:70px;
    display:flex; flex-direction:column; align-items:center; justify-content:center; gap:5px;
  }
  .result-amount {
    font-family:'Playfair Display',serif; font-size:1.75rem; color:var(--gold-light);
    opacity:0; transform:translateY(8px);
    transition:all 0.4s cubic-bezier(0.16,1,0.3,1);
  }
  .result-amount.show { opacity:1; transform:translateY(0); }
  .result-rate { font-size:0.6rem; letter-spacing:0.12em; text-transform:uppercase; color:var(--muted); }
  .result-placeholder { font-size:0.7rem; letter-spacing:0.1em; color:var(--muted); }
  .error-msg { color:#e07070; font-size:0.72rem; }

  #apiSection { margin-bottom:0; }
  .key-actions { display:flex; gap:8px; margin-top:10px; }
  .btn-primary {
    flex:1; background:var(--gold); border:none; color:var(--dark);
    font-family:'DM Mono',monospace; font-size:0.65rem; letter-spacing:0.15em;
    text-transform:uppercase; padding:11px; cursor:pointer; transition:background 0.2s;
  }
  .btn-primary:hover { background:var(--gold-light); }
  .btn-ghost {
    flex:1; background:transparent; border:1px solid var(--border); color:var(--muted);
    font-family:'DM Mono',monospace; font-size:0.65rem; letter-spacing:0.1em;
    text-transform:uppercase; padding:11px; cursor:pointer; transition:all 0.2s;
  }
  .btn-ghost:hover { border-color:var(--gold); color:var(--text); }
  .hint { margin-top:8px; font-size:0.57rem; letter-spacing:0.08em; color:var(--muted); }
  .hint a { color:var(--gold); text-decoration:none; }
</style>
</head>
<body>
<div class="card">
  <h1>Currency Converter</h1>
  <div class="subtitle">Live Exchange Rates</div>

  <!-- Step 1: API Key -->
  <div id="apiSection">
    <div class="field">
      <label>ExchangeRate-API Key</label>
      <input type="text" id="apiKey" placeholder="Paste your free API key here…">
    </div>
    <div class="key-actions">
      <button class="btn-primary" onclick="initWithKey()">Load Currencies</button>
      <button class="btn-ghost" onclick="useDemoMode()">Demo Mode</button>
    </div>
    <div class="hint">Free key at <a href="https://www.exchangerate-api.com" target="_blank">exchangerate-api.com</a> · Demo uses static rates</div>
  </div>

  <!-- Step 2: Converter UI -->
  <div id="converterUI" style="display:none">
    <div class="pair-row">
      <div class="field">
        <label>From</label>
        <select id="fromCurrency"></select>
      </div>
      <button class="switch-btn" id="switchBtn" onclick="switchCurrencies()" title="Switch">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M2 5h10M9 2l3 3-3 3M14 11H4M7 8l-3 3 3 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <div class="field">
        <label>To</label>
        <select id="toCurrency"></select>
      </div>
    </div>

    <div class="amount-row">
      <div class="field">
        <label>Amount</label>
        <input type="number" id="amount" value="1" min="0" step="any">
      </div>
      <button class="convert-btn" onclick="convert()">Convert</button>
    </div>

    <div class="result-box" id="resultBox">
      <div class="result-placeholder">Enter an amount and click Convert</div>
    </div>
  </div>
</div>

<script>
let API_KEY = 'e4ef82b606143b22656fbda2';
let demoMode = false;
const DEMO = {
  USD:1,EUR:0.921,GBP:0.787,JPY:149.5,ILS:3.673,CAD:1.357,AUD:1.534,
  CHF:0.882,CNY:7.24,INR:83.1,MXN:17.15,BRL:4.97,KRW:1325,SGD:1.341,
  NOK:10.55,SEK:10.42,DKK:6.88,NZD:1.628,HKD:7.821,TRY:30.5,ZAR:18.7,
  AED:3.673,SAR:3.75,THB:35.1,MYR:4.71,PHP:56.2,IDR:15600,MAD:10.05,EGP:30.9
};

async function initWithKey() {
  const key = document.getElementById('apiKey').value.trim();
  if (!key) { alert('Please enter your API key.'); return; }
  API_KEY = key;
  await loadCurrencies();
}

function useDemoMode() {
  demoMode = true;
  loadCurrencies();
}

async function loadCurrencies() {
  let codes;
  if (demoMode) {
    codes = Object.keys(DEMO).map(c => [c, c]);
  } else {
    try {
      const res = await fetch(`https://v6.exchangerate-api.com/v6/${API_KEY}/codes`);
      const data = await res.json();
      if (data.result !== 'success') throw new Error(data['error-type'] || 'API error');
      codes = data.supported_codes;
    } catch(e) {
      alert('Error: ' + e.message); return;
    }
  }

  const fromSel = document.getElementById('fromCurrency');
  const toSel = document.getElementById('toCurrency');
  fromSel.innerHTML = '';
  toSel.innerHTML = '';
  codes.forEach(([code, name]) => {
    const label = demoMode ? code : `${code} — ${name}`;
    const opt = `<option value="${code}">${label}</option>`;
    fromSel.insertAdjacentHTML('beforeend', opt);
    toSel.insertAdjacentHTML('beforeend', opt);
  });
  fromSel.value = 'USD';
  toSel.value = 'ILS';

  document.getElementById('apiSection').style.display = 'none';
  document.getElementById('converterUI').style.display = 'block';
}

async function convert() {
  const from = document.getElementById('fromCurrency').value;
  const to = document.getElementById('toCurrency').value;
  const amount = parseFloat(document.getElementById('amount').value);
  const box = document.getElementById('resultBox');

  if (!amount || isNaN(amount) || amount <= 0) {
    box.innerHTML = '<div class="error-msg">Please enter a valid amount.</div>';
    return;
  }

  box.innerHTML = '<div class="result-placeholder">Fetching rate…</div>';

  try {
    let converted, rate;
    if (demoMode) {
      rate = DEMO[to] / DEMO[from];
      converted = amount * rate;
    } else {
      const res = await fetch(`https://v6.exchangerate-api.com/v6/${API_KEY}/pair/${from}/${to}/${amount}`);
      const data = await res.json();
      if (data.result !== 'success') throw new Error(data['error-type'] || 'API error');
      converted = data.conversion_result;
      rate = data.conversion_rate;
    }

    box.innerHTML = `
      <div class="result-amount" id="ramt">${converted.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:4})} ${to}</div>
      <div class="result-rate">1 ${from} = ${rate.toFixed(6)} ${to}</div>`;
    requestAnimationFrame(() => requestAnimationFrame(() => {
      document.getElementById('ramt')?.classList.add('show');
    }));
  } catch(e) {
    box.innerHTML = `<div class="error-msg">${e.message}</div>`;
  }
}

function switchCurrencies() {
  const f = document.getElementById('fromCurrency');
  const t = document.getElementById('toCurrency');
  const btn = document.getElementById('switchBtn');
  [f.value, t.value] = [t.value, f.value];
  btn.classList.add('spinning');
  setTimeout(() => btn.classList.remove('spinning'), 420);
  if (document.querySelector('.result-amount')) convert();
}

document.addEventListener('keydown', e => {
  if (e.key === 'Enter' && document.getElementById('converterUI').style.display !== 'none') convert();
});
</script>
</body>
</html>